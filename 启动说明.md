# 启动和修复说明

## 解决端口占用问题

如果遇到 `EADDRINUSE: address already in use :::3000` 错误，说明端口3000已被占用。

### 方法1：使用PowerShell脚本（推荐）

在 `backend` 目录下运行：

```powershell
.\kill-port.ps1
```

然后重新启动服务器：

```powershell
npm start
```

### 方法2：手动停止进程

1. 打开任务管理器（Ctrl+Shift+Esc）
2. 找到 Node.js 进程
3. 结束进程
4. 重新运行 `npm start`

### 方法3：更改端口

如果不想停止其他进程，可以修改 `backend/server.js` 中的端口：

```javascript
const PORT = process.env.PORT || 3001; // 改为3001或其他端口
```

同时需要修改 `样式预览/script.js` 中的API地址：

```javascript
const API_BASE_URL = 'http://localhost:3001/api'; // 改为对应端口
```

## 备忘录404错误

如果备忘录保存时出现404错误，请检查：

1. **确保服务器正在运行**
   ```powershell
   cd backend
   npm start
   ```

2. **检查服务器是否正常启动**
   - 应该看到：`🚀 服务器运行在 http://localhost:3000`
   - 应该看到：`✅ 数据库已就绪`

3. **测试API是否可用**
   - 在浏览器中访问：`http://localhost:3000/api/health`
   - 应该返回：`{"status":"ok","message":"服务器运行正常"}`

4. **检查浏览器控制台**
   - 按F12打开开发者工具
   - 查看Console标签页的错误信息
   - 查看Network标签页，检查API请求是否成功

## 标签更新问题

标签应该在以下情况自动更新：
- ✅ 上传照片后
- ✅ 删除照片后
- ✅ 创建新标签后

如果标签没有更新，请：
1. 刷新页面（F5）
2. 检查浏览器控制台是否有错误
3. 确认服务器正在运行

## 完整启动流程

1. **停止旧进程**（如果端口被占用）
   ```powershell
   cd backend
   .\kill-port.ps1
   ```

2. **启动服务器**
   ```powershell
   npm start
   ```

3. **打开网页**
   - 在浏览器中打开 `样式预览/index.html`
   - 或使用本地服务器（如Live Server）

4. **测试功能**
   - 创建备忘录
   - 上传照片
   - 创建标签
   - 查看分类

